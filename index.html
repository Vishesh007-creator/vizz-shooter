<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Vizz Shooter</title>
  <style>
    body {
      margin: 0;
      background: #020617;
      display: flex;
      justify-content: center;
      align-items: center;
      height: 100vh;
      font-family: system-ui, sans-serif;
      color: #e5e7eb;
    }
    .wrapper {
      text-align: center;
    }
    #gameCanvas {
      background: #020617;
      border: 2px solid #22c55e;
      box-shadow: 0 0 25px rgba(34,197,94,0.5);
      border-radius: 10px;
    }
    .info {
      margin-top: 8px;
      font-size: 0.9rem;
      color: #9ca3af;
    }
  </style>
</head>
<body>
<div class="wrapper">
  <canvas id="gameCanvas" width="480" height="640"></canvas>
  <div class="info">
    Move: ⬅️ ➡️ (A / D) &nbsp;|&nbsp; Shoot: SPACE &nbsp;|&nbsp; Restart: ENTER
  </div>
</div>

<script>
  const canvas = document.getElementById("gameCanvas");
  const ctx = canvas.getContext("2d");

  const player = {
    x: canvas.width / 2 - 20,
    y: canvas.height - 60,
    w: 40,
    h: 40,
    speed: 5
  };

  const bullets = [];
  const enemies = [];

  let keys = {};
  let lastShotTime = 0;
  const shotCooldown = 250; // ms
  let lastEnemySpawn = 0;
  const enemySpawnDelay = 800; // ms
  let score = 0;
  let lives = 3;
  let gameOver = false;

  window.addEventListener("keydown", (e) => {
    keys[e.code] = true;
    // space prevented from scrolling page if embedded
    if (e.code === "Space") e.preventDefault();
  });

  window.addEventListener("keyup", (e) => {
    keys[e.code] = false;
  });

  function shoot(time) {
    if (time - lastShotTime < shotCooldown) return;
    lastShotTime = time;
    bullets.push({
      x: player.x + player.w / 2 - 3,
      y: player.y,
      w: 6,
      h: 12,
      speed: 8
    });
  }

  function spawnEnemy(time) {
    if (time - lastEnemySpawn < enemySpawnDelay) return;
    lastEnemySpawn = time;
    const size = 30;
    const x = Math.random() * (canvas.width - size);
    enemies.push({
      x,
      y: -size,
      w: size,
      h: size,
      speed: 2 + Math.random() * 2
    });
  }

  function rectsCollide(a, b) {
    return (
      a.x < b.x + b.w &&
      a.x + a.w > b.x &&
      a.y < b.y + b.h &&
      a.y + a.h > b.y
    );
  }

  function resetGame() {
    score = 0;
    lives = 3;
    bullets.length = 0;
    enemies.length = 0;
    player.x = canvas.width / 2 - 20;
    gameOver = false;
  }

  function update(delta, time) {
    if (gameOver) {
      if (keys["Enter"]) resetGame();
      return;
    }

    // Move player
    if (keys["ArrowLeft"] || keys["KeyA"]) {
      player.x -= player.speed;
    }
    if (keys["ArrowRight"] || keys["KeyD"]) {
      player.x += player.speed;
    }
    // clamp inside screen
    if (player.x < 0) player.x = 0;
    if (player.x + player.w > canvas.width) player.x = canvas.width - player.w;

    // Shooting
    if (keys["Space"]) {
      shoot(time);
    }

    // Spawn enemies
    spawnEnemy(time);

    // Update bullets
    for (let i = bullets.length - 1; i >= 0; i--) {
      const b = bullets[i];
      b.y -= b.speed;
      if (b.y + b.h < 0) {
        bullets.splice(i, 1);
      }
    }

    // Update enemies
    for (let i = enemies.length - 1; i >= 0; i--) {
      const en = enemies[i];
      en.y += en.speed;

      // Enemy reached bottom
      if (en.y > canvas.height) {
        enemies.splice(i, 1);
        lives--;
        if (lives <= 0) gameOver = true;
        continue;
      }

      // Collision with player
      if (rectsCollide(en, player)) {
        enemies.splice(i, 1);
        lives--;
        if (lives <= 0) gameOver = true;
      }
    }

    // Bullet vs enemy collisions
    for (let i = enemies.length - 1; i >= 0; i--) {
      const en = enemies[i];
      for (let j = bullets.length - 1; j >= 0; j--) {
        const b = bullets[j];
        if (rectsCollide(en, b)) {
          enemies.splice(i, 1);
          bullets.splice(j, 1);
          score += 10;
          break;
        }
      }
    }
  }

  function draw() {
    ctx.clearRect(0, 0, canvas.width, canvas.height);

    // background stars
    ctx.fillStyle = "#020617";
    ctx.fillRect(0,0,canvas.width,canvas.height);

    // player
    ctx.fillStyle = "#22c55e";
    ctx.fillRect(player.x, player.y, player.w, player.h);

    // gun barrel
    ctx.fillStyle = "#4ade80";
    ctx.fillRect(player.x + player.w/2 - 4, player.y - 10, 8, 10);

    // bullets
    ctx.fillStyle = "#e5e7eb";
    bullets.forEach(b => {
      ctx.fillRect(b.x, b.y, b.w, b.h);
    });

    // enemies
    ctx.fillStyle = "#ef4444";
    enemies.forEach(en => {
      ctx.fillRect(en.x, en.y, en.w, en.h);
    });

    // HUD
    ctx.fillStyle = "#e5e7eb";
    ctx.font = "16px system-ui";
    ctx.fillText("Score: " + score, 10, 24);
    ctx.fillText("Lives: " + lives, canvas.width - 90, 24);

    if (gameOver) {
      ctx.fillStyle = "rgba(15,23,42,0.85)";
      ctx.fillRect(40, canvas.height / 2 - 80, canvas.width - 80, 160);

      ctx.fillStyle = "#f97373";
      ctx.font = "26px system-ui";
      ctx.textAlign = "center";
      ctx.fillText("GAME OVER", canvas.width / 2, canvas.height / 2 - 20);

      ctx.fillStyle = "#e5e7eb";
      ctx.font = "16px system-ui";
      ctx.fillText("Final Score: " + score, canvas.width / 2, canvas.height / 2 + 10);
      ctx.fillText("Press ENTER to restart", canvas.width / 2, canvas.height / 2 + 40);
      ctx.textAlign = "start";
    }
  }

  let lastTime = 0;
  function loop(timestamp) {
    const delta = timestamp - lastTime;
    lastTime = timestamp;

    update(delta, timestamp);
    draw();

    requestAnimationFrame(loop);
  }

  requestAnimationFrame(loop);
</script>
</body>
</html>
